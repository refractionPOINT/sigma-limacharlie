detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - case sensitive: false
    op: contains
    path: event/COMMAND_LINE
    value: ::FromBase64String(
respond:
- action: report
  metadata:
    author: Florian Roth (Nextron Systems)
    description: Detects usage of the "FromBase64String" function in the commandline
      which is used to decode a base64 encoded string
    falsepositives:
    - Administrative script libraries
    level: high
    references:
    - https://gist.github.com/Neo23x0/6af876ee72b51676c82a2db8d2cd3639
    tags:
    - attack.t1027
    - attack.defense-evasion
    - attack.execution
    - attack.t1140
    - attack.t1059.001
  name: Base64 Encoded PowerShell Command Detected

