detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - case sensitive: false
    op: ends with
    path: event/PARENT/FILE_PATH
    value: \odbcconf.exe
respond:
- action: report
  metadata:
    author: Harjot Singh @cyb3rjy0t
    description: Detects an uncommon child process of "odbcconf.exe" binary which
      normally shouldn't have any child processes.
    falsepositives:
    - In rare occurrences where "odbcconf" crashes. It might spawn a "werfault" process
    - Other child processes will depend on the DLL being registered by actions like
      "regsvr". In case where the DLLs have external calls (which should be rare).
      Other child processes might spawn and additional filters need to be applied.
    level: medium
    references:
    - https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16
    - https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/
    - https://medium.com/@cyberjyot/t1218-008-dll-execution-using-odbcconf-exe-803fa9e08dac
    tags:
    - attack.defense-evasion
    - attack.t1218.008
  name: Uncommon Child Process Spawned By Odbcconf.EXE

