detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: or
    rules:
    - op: and
      rules:
      - case sensitive: false
        op: ends with
        path: event/PARENT/FILE_PATH
        value: \WINWORD.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: .tmp
    - op: and
      rules:
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \wmic.exe
      - case sensitive: false
        op: contains
        path: event/PARENT/FILE_PATH
        value: \Temp\
      - case sensitive: false
        op: ends with
        path: event/COMMAND_LINE
        value: shadowcopy delete
    - op: and
      rules:
      - case sensitive: false
        op: ends with
        path: event/COMMAND_LINE
        value: shadowcopy delete
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: \..\..\system32
respond:
- action: report
  metadata:
    author: Florian Roth
    description: Detects specific process characteristics of Maze ransomware word
      document droppers
    falsepositives:
    - Unlikely
    level: critical
    references:
    - https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html
    - https://app.any.run/tasks/51e7185c-52d7-4efb-ac0d-e86340053473/
    - https://app.any.run/tasks/65a79440-373a-4725-8d74-77db9f2abda4/
    tags:
    - attack.execution
    - attack.t1204.002
    - attack.t1047
    - attack.impact
    - attack.t1490
  name: Maze Ransomware

