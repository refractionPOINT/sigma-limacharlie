detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - op: or
      rules:
      - op: or
        rules:
        - case sensitive: false
          op: is
          path: event/ORIGINAL_FILE_NAME
          value: net.exe
        - case sensitive: false
          op: is
          path: event/ORIGINAL_FILE_NAME
          value: net1.exe
        - case sensitive: false
          op: is
          path: event/ORIGINAL_FILE_NAME
          value: PowerShell.EXE
        - case sensitive: false
          op: is
          path: event/ORIGINAL_FILE_NAME
          value: psservice.exe
        - case sensitive: false
          op: is
          path: event/ORIGINAL_FILE_NAME
          value: pwsh.dll
        - case sensitive: false
          op: is
          path: event/ORIGINAL_FILE_NAME
          value: sc.exe
      - op: or
        rules:
        - case sensitive: false
          op: ends with
          path: event/FILE_PATH
          value: \net.exe
        - case sensitive: false
          op: ends with
          path: event/FILE_PATH
          value: \net1.exe
        - case sensitive: false
          op: ends with
          path: event/FILE_PATH
          value: \powershell.exe
        - case sensitive: false
          op: ends with
          path: event/FILE_PATH
          value: \PsService.exe
        - case sensitive: false
          op: ends with
          path: event/FILE_PATH
          value: \PsService64.exe
        - case sensitive: false
          op: ends with
          path: event/FILE_PATH
          value: \pwsh.exe
        - case sensitive: false
          op: ends with
          path: event/FILE_PATH
          value: \sc.exe
    - op: or
      rules:
      - op: or
        rules:
        - case sensitive: false
          op: contains
          path: event/COMMAND_LINE
          value: ' delete '
        - case sensitive: false
          op: contains
          path: event/COMMAND_LINE
          value: ' pause '
        - case sensitive: false
          op: contains
          path: event/COMMAND_LINE
          value: ' stop '
        - case sensitive: false
          op: contains
          path: event/COMMAND_LINE
          value: 'Stop-Service '
        - case sensitive: false
          op: contains
          path: event/COMMAND_LINE
          value: 'Remove-Service '
      - op: and
        rules:
        - case sensitive: false
          op: contains
          path: event/COMMAND_LINE
          value: config
        - case sensitive: false
          op: contains
          path: event/COMMAND_LINE
          value: start=disabled
    - op: or
      rules:
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: 143Svc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Acronis VSS Provider
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: AcronisAgent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: AcrSch2Svc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: AdobeARMservice
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: AHS Service
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Antivirus
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Apache4
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ARSM
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: aswBcc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: AteraAgent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Avast Business Console Client Antivirus Service
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: avast! Antivirus
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: AVG Antivirus
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: avgAdminClient
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: AvgAdminServer
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: AVP1
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: BackupExec
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: bedbg
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: BITS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: BrokerInfrastructure
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: CASLicenceServer
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: CASWebServer
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Client Agent 7.60
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Core Browsing Protection
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Core Mail Protection
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Core Scanning Server
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: DCAgent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: dwmrcs
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: EhttpSr
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ekrn
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Enterprise Client Service
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: epag
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: EPIntegrationService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: EPProtectedService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: EPRedline
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: EPSecurityService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: EPUpdateService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: EraserSvc11710
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: EsgShKernel
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ESHASRV
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: FA_Scheduler
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: FirebirdGuardianDefaultInstance
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: FirebirdServerDefaultInstance
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: FontCache3.0.0.0
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: HealthTLService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: hmpalertsvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: HMS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: HostControllerService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: hvdsvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: IAStorDataMgrSvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: IBMHPS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ibmspsvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: IISAdmin
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: IMANSVC
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: IMAP4Svc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: instance2
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: KAVFS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: KAVFSGT
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: kavfsslp
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: KeyIso
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klbackupdisk
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klbackupflt
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klflt
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klhk
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: KLIF
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klim6
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klkbdflt
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klmouflt
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klnagent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: klpd
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: kltap
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: KSDE1.0.0
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: LogProcessorService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: M8EndpointAgent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: macmnsvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: masvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MBAMService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MBCloudEA
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MBEndpointAgent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: McAfeeDLPAgentService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: McAfeeEngineService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MCAFEEEVENTPARSERSRV
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: McAfeeFramework
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MCAFEETOMCATSRV530
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: McShield
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: McTaskManager
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: mfefire
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: mfemms
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: mfevto
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: mfevtp
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: mfewc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MMS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: mozyprobackup
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: mpssvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSComplianceAudit
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSDTC
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MsDtsServer
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSExchange
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: msftesq1SPROO
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: msftesql$PROD
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: msftesql$SQLEXPRESS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSOLAP$SQL_2008
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSOLAP$SYSTEM_BGC
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSOLAP$TPS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSOLAP$TPSAMA
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSOLAPSTPS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSOLAPSTPSAMA
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: mssecflt
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSSQ!I.SPROFXENGAGEMEHT
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSSQ0SHAREPOINT
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSSQ0SOPHOS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSSQL
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MSSQLFDLauncher$
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: MySQL
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: NanoServiceMain
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: NetMsmqActivator
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: NetPipeActivator
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: netprofm
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: NetTcpActivator
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: NetTcpPortSharing
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ntrtscan
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: nvspwmi
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ofcservice
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Online Protection System
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: OracleClientCache80
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: OracleDBConsole
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: OracleMTSRecoveryService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: OracleOraDb11g_home1
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: OracleService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: OracleVssWriter
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: osppsvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: PandaAetherAgent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: PccNTUpd
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: PDVFSService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: POP3Svc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: postgresql-x64-9.4
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: POVFSService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: PSUAService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Quick Update Service
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: RepairService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ReportServer
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ReportServer$
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: RESvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: RpcEptMapper
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: sacsvr
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SamSs
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SAVAdminService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SAVService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ScSecSvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SDRSVC
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SearchExchangeTracing
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: sense
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SentinelAgent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SentinelHelperService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SepMasterService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ShMonitor
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Smcinst
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SmcService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SMTPSvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SNAC
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SntpService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Sophos
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQ1SafeOLRService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQL Backups
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQL Server
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQLAgent
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQLANYs_Sage_FAS_Fixed_Assets
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQLBrowser
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQLsafe
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQLSERVERAGENT
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQLTELEMETRY
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SQLWriter
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SSISTELEMETRY130
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: SstpSvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: storflt
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: svcGenericHost
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: swc_service
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: swi_filter
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: swi_service
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: swi_update
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Symantec
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: sysmon
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TeamViewer
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Telemetryserver
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ThreatLockerService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TMBMServer
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TmCCSF
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TmFilter
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TMiCRCScanService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: tmlisten
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TMLWCSService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TmPfw
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TmPreFilter
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TmProxy
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TMSmartRelayService
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: tmusa
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Tomcat
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Trend Micro Deep Security Manager
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: TrueKey
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: UFNet
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: UI0Detect
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: UniFi
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: UTODetect
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: vds
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Veeam
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: VeeamDeploySvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Veritas System Recovery
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: vmic
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: VMTools
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: vmvss
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: VSApiNt
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: VSS
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: W3Svc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: wbengine
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: WdNisSvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: WeanClOudSve
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Weems JY
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: WinDefend
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: wmms
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: wozyprobackup
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: WPFFontCache_v0400
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: WRSVC
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: wsbexchange
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: WSearch
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: wscsvc
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: Zoolz 2 Service
respond:
- action: report
  metadata:
    author: Nasreddine Bencherchali (Nextron Systems), frack113 , X__Junior
    description: 'Detects the usage of binaries such as ''net'', ''sc'' or ''powershell''
      in order to stop, pause, disable or delete critical or important Windows services
      such as AV, Backup, etc. As seen being used in some ransomware scripts

      '
    falsepositives:
    - Administrators or tools shutting down the services due to upgrade or removal
      purposes. If you experience some false positive, please consider adding filters
      to the parent process launching this command and not removing the entry
    level: high
    references:
    - https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus/Genshin%20Impact%20Figure%2010.jpg
    - https://www.trellix.com/en-sg/about/newsroom/stories/threat-labs/lockergoga-ransomware-family-used-in-targeted-attacks.html
    - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
    - https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/
    - https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955
    tags:
    - attack.defense-evasion
    - attack.impact
    - attack.t1489
    - attack.t1562.001
  name: Suspicious Windows Service Tampering

