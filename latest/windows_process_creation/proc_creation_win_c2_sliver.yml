detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - case sensitive: false
    op: contains
    path: event/COMMAND_LINE
    value: -NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8
respond:
- action: report
  metadata:
    author: Nasreddine Bencherchali, Florian Roth
    description: Detects process activity patterns as seen being used by Sliver C2
      framework implants
    falsepositives:
    - Unlikely
    level: critical
    references:
    - https://github.com/BishopFox/sliver/blob/79f2d48fcdfc2bee4713b78d431ea4b27f733f30/implant/sliver/shell/shell_windows.go#L36
    - https://www.microsoft.com/security/blog/2022/08/24/looking-for-the-sliver-lining-hunting-for-emerging-command-and-control-frameworks/
    tags:
    - attack.execution
    - attack.t1059
  name: Sliver C2 Implant Activity Pattern

