detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - op: or
      rules:
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \fsutil.exe
      - case sensitive: false
        op: is
        path: event/ORIGINAL_FILE_NAME
        value: fsutil.exe
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: drives
respond:
- action: report
  metadata:
    author: Christopher Peacock '@securepeacock', SCYTHE '@scythe_io'
    description: Attackers may leverage fsutil to enumerated connected drives.
    falsepositives:
    - Certain software or administrative tasks may trigger false positivies.
    level: low
    references:
    - Turla has used fsutil fsinfo drives to list connected drives. https://attack.mitre.org/techniques/T1120/
    - https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/discovery_peripheral_device.toml
    tags:
    - attack.peripheral_device_discovery
    - attack.t1120
  name: Fsutil Drive Enumeration

