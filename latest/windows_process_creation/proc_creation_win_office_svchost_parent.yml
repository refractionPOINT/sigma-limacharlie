detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - case sensitive: false
      op: ends with
      path: event/PARENT/FILE_PATH
      value: \svchost.exe
    - op: or
      rules:
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \winword.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \excel.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \powerpnt.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \msaccess.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \mspub.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \eqnedt32.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \visio.exe
respond:
- action: report
  metadata:
    author: Nasreddine Bencherchali (Nextron Systems)
    description: 'Detects an svchost process spawning an instance of an office application.
      This happens when the initial word application creates an instance of one of
      the Office COM objects such as ''Word.Application'', ''Excel.Application'',
      etc.

      This can be used by malicious actors to create malicious Office documents with
      macros on the fly. (See vba2clr project in the references)

      '
    falsepositives:
    - Legitimate usage of office automation via scripting
    level: medium
    references:
    - https://learn.microsoft.com/en-us/previous-versions/office/troubleshoot/office-developer/automate-word-create-file-using-visual-basic
    - https://github.com/med0x2e/vba2clr
    tags:
    - attack.execution
    - attack.defense_evasion
  name: Suspicious New Instance Of An Office COM Object

