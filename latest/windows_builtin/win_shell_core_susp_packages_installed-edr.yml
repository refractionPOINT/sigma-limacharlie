detect:
  event: WEL
  op: and
  rules:
  - op: is windows
  - op: or
    rules:
    - op: and
      rules:
      - case sensitive: false
        op: is
        path: event/EVENT/System/EventID
        value: '28115'
      - op: or
        rules:
        - case sensitive: false
          op: contains
          path: event/EVENT/EventData/Name
          value: Zenmap
        - case sensitive: false
          op: contains
          path: event/EVENT/EventData/Name
          value: AnyDesk
        - case sensitive: false
          op: contains
          path: event/EVENT/EventData/Name
          value: wireshark
        - case sensitive: false
          op: contains
          path: event/EVENT/EventData/Name
          value: openvpn
    - op: and
      rules:
      - case sensitive: false
        op: is
        path: event/EVENT/System/EventID
        value: '28115'
      - op: or
        rules:
        - case sensitive: false
          op: contains
          path: event/EVENT/EventData/AppID
          value: zenmap.exe
        - case sensitive: false
          op: contains
          path: event/EVENT/EventData/AppID
          value: prokzult ad
        - case sensitive: false
          op: contains
          path: event/EVENT/EventData/AppID
          value: wireshark
        - case sensitive: false
          op: contains
          path: event/EVENT/EventData/AppID
          value: openvpn
respond:
- action: report
  metadata:
    author: Nasreddine Bencherchali
    description: Detects suspicious application installed by looking at the added
      shortcut to the app resolver cache
    falsepositives:
    - Packages or applications being legitimately used by users or administrators
    level: medium
    references:
    - https://nasbench.medium.com/finding-forensic-goodness-in-obscure-windows-event-logs-60e978ea45a3
    tags:
    - attack.execution
  name: Suspicious Application Installed

