detect:
  log type: wel
  op: and
  rules:
  - op: and
    rules:
    - op: or
      rules:
      - case sensitive: false
        op: is
        path: Event/System/EventID
        value: '4625'
      - case sensitive: false
        op: is
        path: Event/System/EventID
        value: '4776'
    - op: or
      rules:
      - case sensitive: false
        op: is
        path: Event/EventData/Status
        value: '0xC0000072'
      - case sensitive: false
        op: is
        path: Event/EventData/Status
        value: '0xC000006F'
      - case sensitive: false
        op: is
        path: Event/EventData/Status
        value: '0xC0000070'
      - case sensitive: false
        op: is
        path: Event/EventData/Status
        value: '0xC0000413'
      - case sensitive: false
        op: is
        path: Event/EventData/Status
        value: '0xC000018C'
      - case sensitive: false
        op: is
        path: Event/EventData/Status
        value: '0xC000015B'
  - case sensitive: false
    not: true
    op: is
    path: Event/EventData/SubjectUserSid
    value: S-1-0-0
  target: log
respond:
- action: report
  metadata:
    author: Florian Roth
    description: This method uses uncommon error codes on failed logons to determine
      suspicious activity and tampering with accounts that have been disabled or somehow
      restricted.
    falsepositives:
    - User using a disabled account
    level: medium
    references:
    - https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4625
    - https://twitter.com/SBousseaden/status/1101431884540710913
    tags:
    - attack.persistence
    - attack.defense_evasion
    - attack.privilege_escalation
    - attack.initial_access
    - attack.t1078
  name: Account Tampering - Suspicious Failed Logon Reasons

