detect:
  log type: wel
  op: and
  rules:
  - op: and
    rules:
    - case sensitive: false
      op: is
      path: Event/System/EventID
      value: '4719'
    - op: or
      rules:
      - case sensitive: false
        op: contains
        path: Event/EventData/AuditPolicyChanges
        value: '%%8448'
      - case sensitive: false
        op: contains
        path: Event/EventData/AuditPolicyChanges
        value: '%%8450'
  - not: true
    op: or
    rules:
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9215-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE922B-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9240-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9210-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9211-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9212-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE921B-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE922F-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9230-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9235-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9236-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9237-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE923F-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9242-69AE-11D9-BED3-505054503030}'
    - case sensitive: false
      op: is
      path: Event/EventData/SubcategoryGuid
      value: '{0CCE9217-69AE-11D9-BED3-505054503030}'
  target: log
respond:
- action: report
  metadata:
    author: '@neu5ron, Nasreddine Bencherchali (Nextron Systems)'
    description: 'Detects scenarios where system auditing (i.e.: Windows event log
      auditing) is disabled.

      This may be used in a scenario where an entity would want to bypass local logging
      to evade detection when Windows event logging is enabled and reviewed.

      Also, it is recommended to turn off "Local Group Policy Object Processing" via
      GPO, which will make sure that Active Directory GPOs take precedence over local/edited
      computer policies via something such as "gpedit.msc".

      Please note, that disabling "Local Group Policy Object Processing" may cause
      an issue in scenarios of one off specific GPO modifications - however, it is
      recommended to perform these modifications in Active Directory anyways.

      '
    falsepositives:
    - Unknown
    level: medium
    references:
    - https://docs.google.com/presentation/d/1dkrldTTlN3La-OjWtkWJBb4hVk6vfsSMBFBERs6R8zA/edit
    tags:
    - attack.defense_evasion
    - attack.t1562.002
  name: Windows Event Auditing Disabled

