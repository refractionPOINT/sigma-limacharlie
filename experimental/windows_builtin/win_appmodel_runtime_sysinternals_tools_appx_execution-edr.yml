detect:
  event: WEL
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - case sensitive: false
      op: is
      path: event/EVENT/System/EventID
      value: '201'
    - op: or
      rules:
      - case sensitive: false
        op: is
        path: event/EVENT/EventData/ImageName
        value: procdump.exe
      - case sensitive: false
        op: is
        path: event/EVENT/EventData/ImageName
        value: psloglist.exe
      - case sensitive: false
        op: is
        path: event/EVENT/EventData/ImageName
        value: psexec.exe
      - case sensitive: false
        op: is
        path: event/EVENT/EventData/ImageName
        value: livekd.exe
      - case sensitive: false
        op: is
        path: event/EVENT/EventData/ImageName
        value: ADExplorer.exe
respond:
- action: report
  metadata:
    author: Nasreddine Bencherchali (Nextron Systems)
    description: Detects execution of Sysinternals tools via an AppX package. Attackers
      could install the Sysinternals Suite to get access to tools such as psexec and
      procdump to avoid detection based on System paths
    falsepositives:
    - Legitimate usage of the applications from the Windows Store
    level: low
    references:
    - Internal Research
    tags:
    - attack.defense-evasion
    - attack.execution
  name: Sysinternals Tools AppX Versions Execution

