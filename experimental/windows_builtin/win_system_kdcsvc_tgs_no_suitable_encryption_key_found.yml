detect:
  log type: wel
  op: and
  rules:
  - case sensitive: false
    op: is
    path: Event/EventData/Provider_Name
    value: Microsoft-Windows-Kerberos-Key-Distribution-Center
  - op: or
    rules:
    - case sensitive: false
      op: is
      path: Event/System/EventID
      value: '16'
    - case sensitive: false
      op: is
      path: Event/System/EventID
      value: '27'
  target: log
respond:
- action: report
  metadata:
    author: '@SerkinValery'
    description: 'Detects errors when a target server doesn''t have suitable keys
      for generating kerberos tickets.

      This issue can occur for example when a service uses a user account or a computer
      account that is configured for only DES encryption on a computer that is running
      Windows 7 which has DES encryption for Kerberos authentication disabled.

      '
    falsepositives:
    - Unknown
    level: low
    references:
    - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd348773(v=ws.10)
    - https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/kdc-event-16-27-des-encryption-disabled
    tags:
    - attack.credential-access
    - attack.t1558.003
  name: No Suitable Encryption Key Found For Generating Kerberos Ticket

