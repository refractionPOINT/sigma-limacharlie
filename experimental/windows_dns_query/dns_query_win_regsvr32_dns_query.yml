detect:
  case sensitive: false
  event: DNS_REQUEST
  op: ends with
  path: event/FILE_PATH
  value: \regsvr32.exe
respond:
- action: report
  metadata:
    author: Dmitriy Lifanov, oscd.community
    description: Detects DNS queries initiated by "Regsvr32.exe"
    falsepositives:
    - Unknown
    level: medium
    references:
    - https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/
    - https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/
    tags:
    - attack.execution
    - attack.t1559.001
    - attack.defense_evasion
    - attack.t1218.010
  name: DNS Query Request By Regsvr32.EXE

