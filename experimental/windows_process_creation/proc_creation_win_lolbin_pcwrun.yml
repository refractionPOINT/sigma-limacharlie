detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - case sensitive: false
    op: ends with
    path: event/PARENT/FILE_PATH
    value: \pcwrun.exe
respond:
- action: report
  metadata:
    author: A. Sungurov , oscd.community
    description: Detect indirect command execution via Program Compatibility Assistant
      pcwrun.exe
    falsepositives:
    - Need to use extra processing with 'unique_count' / 'filter' to focus on outliers
      as opposed to commonly seen artifacts
    - Legit usage of scripts
    level: low
    references:
    - https://twitter.com/pabraeken/status/991335019833708544
    - https://lolbas-project.github.io/lolbas/Binaries/Pcwrun/
    tags:
    - attack.defense_evasion
    - attack.t1218
    - attack.execution
  name: Indirect Command Execution By Program Compatibility Wizard

