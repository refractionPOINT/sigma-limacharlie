detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: or
    rules:
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: Get-Process lsas
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ps lsas
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: gps lsas
respond:
- action: report
  metadata:
    author: Florian Roth (Nextron Systems)
    description: Detects a "Get-Process" cmdlet and it's aliases on lsass process,
      which is in almost all cases a sign of malicious activity
    falsepositives:
    - Unknown
    level: high
    references:
    - https://web.archive.org/web/20220205033028/https://twitter.com/PythonResponder/status/1385064506049630211
    tags:
    - attack.credential_access
    - attack.t1552.004
  name: PowerShell Get-Process LSASS

