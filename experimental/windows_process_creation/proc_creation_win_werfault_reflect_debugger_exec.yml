detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - op: or
      rules:
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \WerFault.exe
      - case sensitive: false
        op: is
        path: event/ORIGINAL_FILE_NAME
        value: WerFault.exe
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ' -pr '
respond:
- action: report
  metadata:
    author: X__Junior (Nextron Systems)
    description: Detects execution of "WerFault.exe" with the "-pr" commandline flag
      that is used to run files stored in the ReflectDebugger key which could be used
      to store the path to the malware in order to masquerade the execution flow
    falsepositives:
    - Unknown
    level: medium
    references:
    - https://cocomelonc.github.io/malware/2022/11/02/malware-pers-18.html
    - https://www.hexacorn.com/blog/2018/08/31/beyond-good-ol-run-key-part-85/
    tags:
    - attack.execution
    - attack.defense-evasion
    - attack.t1036
  name: Potential ReflectDebugger Content Execution Via WerFault.EXE

