detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - op: or
      rules:
      - case sensitive: false
        op: ends with
        path: event/PARENT/FILE_PATH
        value: \Winrar.exe
      - case sensitive: false
        op: ends with
        path: event/PARENT/FILE_PATH
        value: \7zFM.exe
      - case sensitive: false
        op: ends with
        path: event/PARENT/FILE_PATH
        value: \peazip.exe
    - op: or
      rules:
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \isoburn.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \PowerISO.exe
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \ImgBurn.exe
respond:
- action: report
  metadata:
    author: Florian Roth (Nextron Systems)
    description: Detects cases in which an ISO files is opend within an archiver like
      7Zip or Winrar, which is a sign of phishing as threat actors put small ISO files
      in archives as email attachments to bypass certain filters and protective measures
      (mark of web)
    falsepositives:
    - Legitimate cases in which archives contain ISO or IMG files and the user opens
      the archive and the image via clicking and not extraction
    level: high
    references:
    - https://twitter.com/1ZRR4H/status/1534259727059787783
    - https://app.any.run/tasks/e1fe6a62-bce8-4323-a49a-63795d9afd5d/
    tags:
    - attack.initial-access
    - attack.t1566
  name: Phishing Pattern ISO in Archive

