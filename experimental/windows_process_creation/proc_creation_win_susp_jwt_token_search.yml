detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: or
    rules:
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: eyJ0eXAiOi
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: eyJhbGciOi
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ' eyJ0eX'
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ' "eyJ0eX"'
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ' ''eyJ0eX'''
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ' eyJhbG'
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ' "eyJhbG"'
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ' ''eyJhbG'''
respond:
- action: report
  metadata:
    author: Nasreddine Bencherchali (Nextron Systems)
    description: 'Detects possible search for JWT tokens via CLI by looking for the
      string "eyJ0eX" or "eyJhbG".

      This string is used as an anchor to look for the start of the JWT token used
      by microsoft office and similar apps.

      '
    falsepositives:
    - Unknown
    level: medium
    references:
    - https://mrd0x.com/stealing-tokens-from-office-applications/
    tags:
    - attack.credential-access
    - attack.t1528
  name: Potentially Suspicious JWT Token Search Via CLI

