detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - op: or
      rules:
      - case sensitive: false
        op: is
        path: event/ORIGINAL_FILE_NAME
        value: CIPHER.EXE
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \cipher.exe
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: ' /w:'
respond:
- action: report
  metadata:
    author: frack113
    description: 'Detects usage of the "cipher" built-in utility in order to overwrite
      deleted data from disk.

      Adversaries may destroy data and files on specific systems or in large numbers
      on a network to interrupt availability to systems, services, and network resources.

      Data destruction is likely to render stored data irrecoverable by forensic techniques
      through overwriting files or data on local and remote drives

      '
    falsepositives:
    - Unknown
    level: medium
    references:
    - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md#atomic-test-3---overwrite-deleted-data-on-c-drive
    tags:
    - attack.impact
    - attack.t1485
  name: Deleted Data Overwritten Via Cipher.EXE

